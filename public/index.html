<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Dunia</title>
    <style media="screen">
      body {
        font-family: Roboto, Arial, sans-serif;
        background: #ECEFF1;
        color: rgba(0,0,0,0.87);
      }

      a {
        color: rgb(3,155,229);
      }

      #header {
        max-width: 500px;
        margin: 40px auto;
        box-shadow: 0 1px 3px 0 rgba(0,0,0,0.2),0 1px 1px 0 rgba(0,0,0,0.14),0 2px 1px -1px rgba(0,0,0,0.12);
        border-radius: 2px;
        background: white;
        padding: 16px 24px;
      }

      #header h1 {
        font-size: 42px;
        font-weight: 500;
        text-align: center;
        margin: 0 0 16px;
      }

      #content-window {
        max-width: 500px;
        margin: 40px auto;
        box-shadow: 0 1px 3px 0 rgba(0,0,0,0.2),0 1px 1px 0 rgba(0,0,0,0.14),0 2px 1px -1px rgba(0,0,0,0.12);
        border-radius: 2px;
        background: white;
        padding: 16px 24px;
      }

      #content-window h1 {
        font-size: 22px;
        font-weight: 500;
        text-align: center;
        margin: 0 0 16px;
      }

      #content-window p {
        font-weight: 300;
        line-height: 150%;
      }

      #content-window ul {
        list-style: none;
        margin: 16px 0 0;
        padding: 0;
        text-align: center;
      }

      #content-window li a {
        display: inline-block;
        padding: 8px;
        text-transform: uppercase;
        text-decoration: none;
        font-weight: 500;
        background: rgb(3,155,229);
        color: white;
        border: 1px solid rgb(3,155,229);
        border-radius: 3px;
        font-size: 14px;
        box-shadow: 0 2px 5px 0 rgba(0,0,0,.26);
      }

      #map {
        width: 100%;
        height: 400px;
      }
    </style>
  </head>
  <body>
    <div id="header">
      <h1 >Where Should We Go?</h1>
    </div>
    <div id="map"></div>
    <div id="content-window">
      <h1>Click on Interest Points for Info</h1>
      <div id="map-content"></div>
    </div>
    
    <script src="https://www.gstatic.com/firebasejs/3.4.0/firebase.js"></script>
    <script>
      /* *************************************
       * This connects us to FIREBASE
       * *************************************
       */
      var config = {
        apiKey: "AIzaSyCLG6CjQSZcw8KI8QgBBOzRwMfJtkIwkj0",
        authDomain: "hackthenorth-b683f.firebaseapp.com",
        databaseURL: "https://hackthenorth-b683f.firebaseio.com",
        storageBucket: "hackthenorth-b683f.appspot.com",
        messagingSenderId: "453572199626"
      };
      firebase.initializeApp(config);

      /**
       * *************************************
       * This runs GOOGLE MAPS API connections
       * *************************************
       */
      var map;
      
      /*var publicArtSrc = '../data/waterloo_public_art.kml'*/
      function initMap() {
        map = new google.maps.Map(document.getElementById('map'), {
          center: {lat: 43.47, lng: -80.5},
          zoom: 12
        });
      }

      //var storage = firebase.storage();
      var storage = firebase.storage();
      var publicArtRef = storage.ref("opendata/waterloo_public_art_2.kml");
      var publicArtSrc = publicArtRef.getDownloadURL().then(function(url) {
        loadKmlLayer(url, map);
      }).catch(function(error) {
        // TODO
      });

      /**
       * Adds a KMLLayer based on the URL passed. Clicking on a marker
       * results in the balloon content being loaded into the right-hand div.
       * @param {string} src A URL for a KML file.
       */
      function loadKmlLayer(src, map) {
        console.log("Loading KML Layer: " + src);
        var kmlLayer = new google.maps.KmlLayer(src, {
          suppressInfoWindows: true,
          preserveViewport: false,
          map: map
        });
        google.maps.event.addListener(kmlLayer, 'click', function(event) {
          var content = event.featureData.infoWindowHtml;
          var testimonial = document.getElementById('map-content');
          testimonial.innerHTML = content;
        });
       }
    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAHafQFb_sniyg-XC5B_C1oW23sjV1ubIA&callback=initMap"
    async defer></script>
  </body>
</html>
